services:
  myflyitalyadsb:
    #build: ./
    image: ghcr.io/flyitalyadsb/myflyitalyadsb:latest
    container_name: myFlyitalyadsb
    restart: unless-stopped
    ports:
      - "84:84"
    entrypoint: /usr/local/bin/python main.py
    command:
      - --server-listen
      - "0.0.0.0:84"
      - --clients-and-db-update
      - "0"
#      - --url-readsb
#     - "http://readsb_globe:30152/?all"
#      - --url-db
#      - ${URL_DB}
    volumes:
      - ./deployment/db:/database
      - ./deployment/json:/json
      - ./deployment/dati:/dati
      - ./deployment/mlat:/mlat

  mysql:
    image: mysql:latest
    container_name: mysql
    command: --default-authentication-plugin=mysql_native_password
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: ${ROOT_PASSWORD_DB}
      MYSQL_DATABASE: ${NOME_DB}
      MYSQL_USER: ${UTENTE_DB}
      MYSQL_PASSWORD: ${PASSWORD_DB}
    ports:
      - "3307:3306"
#    volumes:
#      - ${MYSQL_DATA_PATH}:/var/lib/mysql

  phpmyadmin:
    image: phpmyadmin/phpmyadmin
    container_name: phpmyadmin
    restart: always
    environment:
      PMA_HOST: mysql
      PMA_USER: ${UTENTE_DB}
      PMA_PASSWORD: ${PASSWORD_DB}
    ports:
      - "5050:80"
    depends_on:
      - mysql